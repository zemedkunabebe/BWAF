[2025-07-31 19:55:18] All necessary functions and model classes have been defined.
[2025-07-31 19:55:19] 
--- Step 3.1: Loading and Preparing All Data for Test Set Analysis ---
[2025-07-31 19:55:19] Loading sequences from ./data/raw/human_genome_annotation/updated_promoter_features_clean.csv...
[2025-07-31 19:55:19] Loading sequences from ./data/raw/human_genome_annotation/updated_non_promoter_sequences.csv...
[2025-07-31 19:55:20] Loading priors from ./data/raw/human_genome_annotation/biological_prior_for_transformer_branch.csv...
[2025-07-31 19:55:38] Loading pre-saved static GAT data from results_bwaf_v3/precomputed_gat_output.pt...
[2025-07-31 19:55:38] Test dataset ready with 6008 samples.
[2025-07-31 19:55:38] 
--- Step 3.4: Loading Trained BWAF Model for XAI Analysis ---
[2025-07-31 19:55:38] Trained BWAF model loaded and ready for interpretability analysis.
[2025-07-31 19:55:38] Extracting BWAF attention weights ONE SAMPLE AT A TIME for memory efficiency...
[2025-07-31 20:21:13] Sample-wise extraction complete. Results saved to results_xai/alpha_weights_analysis_data.csv
[2025-07-31 20:21:13] Loading final analysis data from results_xai/alpha_weights_analysis_data.csv...
[2025-07-31 20:21:13] Analysis DataFrame loaded. Shape: (6008, 14)
[2025-07-31 20:21:13] 
--- Correlation between Priors and Learned Alpha Weights ---
[2025-07-31 20:21:13] 
--- Visualizing Alpha Weight Distributions by Class Label ---
[2025-07-31 20:21:14] Loading analysis data from results_xai/alpha_weights_analysis_data.csv for SHAP analysis...
[2025-07-31 20:21:14] Loaded 6008 samples with 11 prior features for SHAP.
[2025-07-31 20:21:14] NumPy < 2.0 alias `np.int` not found. Patching with `int` for SHAP compatibility.
[2025-07-31 20:21:14] NumPy < 2.0 alias `np.bool` not found. Patching with `bool` for SHAP compatibility.
[2025-07-31 20:21:14] NumPy < 2.0 alias `np.float` not found. Patching with `float` for SHAP compatibility.
[2025-07-31 20:21:14] Preparing data for SHAP explainer...
[2025-07-31 20:21:14] Calculating SHAP values for alpha_seq... (this may take several minutes)
[2025-07-31 20:26:31] Calculating SHAP values for alpha_graph...
[2025-07-31 20:31:49] Visualizing SHAP summary plots and exporting textual feature importances...
[2025-07-31 20:31:50] Found example promoter sequence with TATA box at test set index 1
